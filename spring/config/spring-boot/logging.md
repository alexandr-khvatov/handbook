# Logging

### <mark style="color:yellow;">Логер</mark>

Логер - это объект, область ответственности которого - вывод данных в лог и управление уровнем (детализацией) этого вывода.

Логер создается с помощью фабрики и на этапе создания ему присваивается имя. Имя может быть любым, но по стандарту имя должно быть сопряжено с именем класса, в котором вы собираетесь что-то логировать:

```
Logger logger = LoggerFactory.getLogger(SomeClass.class.getName());
```

Это дает нам имя логера в виде: `ru.aarexer.example.SomeClass`.

Почему так рекомендуется делать?

Потому что важным свойством логгеров является то, что они организованы иерархично. Каждый логгер имеет имя, описывающее иерархию, к которой он принадлежит. Разделитель – точка. Принцип полностью аналогичен формированию имени пакета в `Java`.

Получается выстраивается следующая иерархия логеров:

```
root <- ru <- aarexer <- example <- SomeClass
```

И каждому логеру можно выставить свой уровень. Установленный логгеру уровень вывода распространяется на все его дочерние логгеры, для которых явно не выставлен уровень.

При этом во главе иерархии логеров всегда стоит некотрый дефолтный рутовый(корневой) логер.

Поэтому у всех логеров будет уровень логирования, даже если явно мы не прописали для `ru.aarexer.example.SomeClass` его, то он унаследуется от рутового.

### <mark style="color:yellow;">Аппендер</mark>

#### Appender

Аппендер – это та точка, куда события приходят в конечном итоге. Это может быть файл, БД, консоль, сокет и т.д.

Здесь нас никто не ограничивает - можно написать свой аппендер, который пишет сообщения куда-угодно.

Получается у нас есть две точки, первая - это логгер, это начало пути, вторая - аппендер, это уже конечная точка.

Логеры и аппендеры связаны в отношении `many-to-many`.

У одного логгера может быть несколько аппендеров, а к одному аппендеру может быть привязано несколько логгеров.

Логеры при этому наследуют от родительских не только уровни логирования, но и аппендеры.

Например, если к root-логгеру привязан аппендер A1, а к логгеру `ru.aarexer` – A2, то вывод в логгер `ru.aarexer` попадет в A2 и A1, а вывод в `ru` – только в A1.

***

**Вопрос**:

Пусть у нас есть несколько аппендеров и логеров

| Logger                       | Appender |
| ---------------------------- | -------- |
| root                         | А1       |
| ru.aarexer                   | А2       |
| ru.aarexer.example.SomeClass | А3       |

В какой аппендер попадет лог-сообщение:

```
LoggerFactory.getLogger(SomeClass.class.getName()).info("hello");
```

**Ответ**:

У логеров есть такое свойство как `additivity`. По умолчанию она установлена в `true`.

Это говорит о том, что логер-наследник будет свои события передавать логеру-родителю.

Смотрим на иерархию:

`root <- ru <- aarexer <- example`

Из всего вышесказанного делаем вывод, что событие "hello" с уровнем `Level.INFO` попадет во все три аппендера.

***

Но такое наследование аппендеров можно отключить через конфигурацию, для этого стоит посмотреть в сторону выставления флага `additivity="false"` на логгерах.

### <mark style="color:yellow;">Layout</mark>

Layout - это формат вывода данных.

Т.е как лог-сообщения будут отформативарованы, соответственно тут у каждой библиотеки свой набор доступных форматов.

Теперь пришла пора посмотреть - что вообще есть в `Java`.
